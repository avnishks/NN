#data1 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_1_s1data.csv', header=TRUE)#stringsAsFactors = FALSE
#data2 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_1_s2data.csv', header=TRUE)#stringsAsFactors = FALSE
#data3 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_2_s1data.csv', header=TRUE)#stringsAsFactors = FALSE
# data4 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_2_s2data.csv', header=TRUE)#stringsAsFactors = FALSE
#data5 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_3_s1data.csv', header=TRUE)#stringsAsFactors = FALSE
# data6 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_3_s2data.csv', header=TRUE)#stringsAsFactors = FALSE
# data7 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_4_s1data.csv', header=TRUE)#stringsAsFactors = FALSE
# data8 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_4_s2data.csv', header=TRUE)#stringsAsFactors = FALSE
data9 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_5_s3data.csv', header=TRUE)#stringsAsFactors = FALSE
# data10 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_5_s4data.csv', header=TRUE)#stringsAsFactors = FALSE
# data11 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_6_s3data.csv', header=TRUE)#stringsAsFactors = FALSE
# data12 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_6_s4data.csv', header=TRUE)#stringsAsFactors = FALSE
# data13 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_7_s3data.csv', header=TRUE)#stringsAsFactors = FALSE
# data14 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_7_s4data.csv', header=TRUE)#stringsAsFactors = FALSE
# data15 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_8_s3data.csv', header=TRUE)#stringsAsFactors = FALSE
# data16 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_8_s4data.csv', header=TRUE)#stringsAsFactors = FALSE
# data17 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_9_s1data.csv', header=TRUE)#stringsAsFactors = FALSE
# data18 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_9_s2data.csv', header=TRUE)#stringsAsFactors = FALSE
#data19 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_10_s1data.csv', header=TRUE)#stringsAsFactors = FALSE
# data20 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_10_s2data.csv', header=TRUE)#stringsAsFactors = FALSE
# 
#data21 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_12_s1data.csv', header=TRUE)#stringsAsFactors = FALSE
# data22 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_12_s2data.csv', header=TRUE)#stringsAsFactors = FALSE
# data23 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_14_s1data.csv', header=TRUE)#stringsAsFactors = FALSE
# data24 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_14_s2data.csv', header=TRUE)#stringsAsFactors = FALSE
# data25 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_15_s1data.csv', header=TRUE)#stringsAsFactors = FALSE
# data26 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_15_s2data.csv', header=TRUE)#stringsAsFactors = FALSE
# data27 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_16_s3data.csv', header=TRUE)#stringsAsFactors = FALSE
# data28 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_16_s4data.csv', header=TRUE)#stringsAsFactors = FALSE
# data29 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_17_s3data.csv', header=TRUE)#stringsAsFactors = FALSE
# data30 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_17_s4data.csv', header=TRUE)#stringsAsFactors = FALSE
# data31 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_19_s3data.csv', header=TRUE)#stringsAsFactors = FALSE
#data32 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_19_s4data.csv', header=TRUE)#stringsAsFactors = FALSE
# data33 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_20_s1data.csv', header=TRUE)#stringsAsFactors = FALSE
# data34 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_20_s2data.csv', header=TRUE)#stringsAsFactors = FALSE
#data35 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_21_s1data.csv', header=TRUE)#stringsAsFactors = FALSE
# data36 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_21_s2data.csv', header=TRUE)#stringsAsFactors = FALSE
# data37 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_22_s3data.csv', header=TRUE)#stringsAsFactors = FALSE
# data38 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_22_s4data.csv', header=TRUE)#stringsAsFactors = FALSE
# data39 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_23_s3data.csv', header=TRUE)#stringsAsFactors = FALSE
#data40 <- read.csv('/home/avnish/R/my_data/Dataset2/Exp 1 Data - 20 Subjects/P_23_s4data.csv', header=TRUE)#stringsAsFactors = FALSE

#P1s1<-rbind(data9,data21)#,data3,data4,data5,data6,data7,data8,data9,data10)#,data11,data12,data13,data14,data15,data16,data17,data18,data19,data20,data21,data22,data23,data24,data25,data26,data27,data28,data29,data30,data31,data32,data33,data34,data35,data36,data37,data38,data39,data40)
P1s1<- data.frame(data9, check.rows=TRUE)
p1s1<-P1s1[,c(9,26:27,30:40, 46, 48, 57, 59, 68, 70)]
p1s1[p1s1 ==""]<- NA
p1s1<-p1s1[,colSums(is.na(p1s1))<nrow(p1s1)] #remove column with all NA
p1s1<-p1s1[complete.cases(p1s1),] #remove rows with NA; Not yet...try to ignore na in the algo step
#p1s1<-p1s1[na.omit(p1s1),]

# Ptest<-data.frame(data32)
# ptest<-Ptest[,c(9,26:27,30:40, 46, 48, 57, 59, 68, 70)]
# ptest[ptest ==""]<- NA
# ptest<-ptest[,colSums(is.na(ptest))<nrow(ptest)] #remove column with all NA
# #ptest<-ptest[complete.cases(ptest),] #remove rows with NA; Not yet...try to ignore na in the algo step
# ptest<-ptest[na.omit(ptest),]

## split data into a train and test set
index <- 1:nrow(p1s1)
testindex <- sample(index, trunc(length(index)/3))#randomly choose one-third p1s1 rows to be in the test-set
trainset <- p1s1[-testindex,]
testset <- p1s1[testindex,]
#testsetNew<-ptest[testindex,]

# trainset$Action<-as.numeric(as.character(trainset$Action))
# trainset$missionTime<-as.character(trainset$missionTime)
# trainset$segment<-as.character(trainset$segment)
# trainset$Closest_Screen<-as.character(trainset$Closest_Screen)
# trainset$Closest_Control<-as.character(trainset$Closest_Control)

# trainset$Session<-as.numeric(trainset$Session)
# trainset$longTime<-as.numeric(trainset$longTime)
# trainset$Block<-as.numeric(trainset$Block)
# trainset$ScoreChange<-as.numeric(trainset$ScoreChange)
# trainset$score<-as.numeric(trainset$score)

## svm
library('e1071')
svm.model <- svm(Difficulty ~., data=trainset, cost=10, gamma=.1)#, na.action=na.omit)
svm.pred <- predict(svm.model, testset[,-1], na.action=na.omit)# -6
#svm.pred <- predict(svm.model, testsetNew[,-1])#, na.action=na.omit)# -6

## rpart
library('rpart')
rpart.model <- rpart(Difficulty ~., data=trainset)
rpart.pred <- predict(rpart.model, testset[,-1], type = "class")
#rpart.pred <- predict(rpart.model, testsetNew[,-1], type = "class")

## compute SVM confusion matrix
#a.svm<-table(pred = svm.pred, true = testset[,1])
a.svm<-table(pred = svm.pred, true = testset[,1])
a.svm
CCR.svm<-(a.svm[1,1]+a.svm[2,2]+a.svm[3,3])/(a.svm[1,1]+a.svm[1,2]+a.svm[1,3]+a.svm[2,1]+a.svm[2,2]+a.svm[2,3]+a.svm[3,1]+a.svm[3,2]+a.svm[3,3])
CCR.svm
## compute rpart confusion matrix
a.rpart<-table(pred = rpart.pred, true = testset[,1])
#a.rpart<-table(pred = rpart.pred, true = testset[,1])
a.rpart
CCR.rpart<-(a.rpart[1,1]+a.rpart[2,2]+a.rpart[3,3])/(a.rpart[1,1]+a.rpart[1,2]+a.rpart[1,3]+a.rpart[2,1]+a.rpart[2,2]+a.rpart[2,3]+a.rpart[3,1]+a.rpart[3,2]+a.rpart[3,3])
CCR.rpart